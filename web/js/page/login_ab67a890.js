$(function(){$(".login-btn").click(function(){var e="http://47.92.107.76/server",o=$("#username"),t=$("#password"),n="";if(""==$.trim(o.val())?(n="用户名不能为空",o.focus()):""==$.trim(t.val())&&(n="密码不能为空",t.focus()),""!=n)$(".inputs .msg").html(n);else{var s=$.trim(o.val()),a=$.trim(t.val());$.ajax({type:"POST",url:e+"/login",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{account:s,password:a},dataType:"json",success:function(o){if("200"!=o.code)return $(".inputs .msg").html("用户名或密码不正确，请重新输入"),!1;$.ajax({type:"GET",url:e+"/user/info",headers:{token:o.data.token},dataType:"json",success:function(t){"200"==t.code&&$.ajax({type:"GET",url:e+"/refreshToken",headers:{token:o.data.token},dataType:"json",success:function(e){console.log(e),"200"==e.code&&((new Cookies).set("md_user","username="+t.data.name+"&password="+a+"&token="+o.data.token+"&role="+t.data.roles[0].name,"s3000"),window.location.href="datalist.html")},error:function(e){console.log(e),$(".box .msg").html("请求失败，请联系管理员")}})},error:function(e){console.log(e),$(".inputs .msg").html("请求失败，请联系管理员")}})},error:function(e){console.log(e),$(".inputs .msg").html("请求失败，请联系管理员")}})}})});