function getTableDatas(e,t,a){var n=a+"-1",o=a+"-31";"2017-9"==a||"2017-11"==a?o=a+"-30":"2017-12"==a&&(o=a+"-"+(new Date).getDate()),console.log(n),console.log(o),$.ajax({type:"GET",async:!1,url:e+"/customer/saleState",headers:{token:t},data:{begin:n,end:o},dataType:"json",success:function(e){if("200"==e.code){if(null!=e.data){datas=e.data;var t={};t.mhtml='<li class="menu-3"><span></span><p>成单量</p><p class="white">'+e.data.saledContact[3]+'</p></li><li class="menu-2" data-box="box-2"><span></span><p>意向量</p><p class="white">'+e.data.intentedContact[3]+'</p></li><li class="menu-1" data-box="box-1"><span></span><p>动态线索量</p><p class="white">'+e.data.totalContact[3]+'</p></li><li class="menu-4" data-box="box-4"><span></span><p>接通量</p><p class="white">'+e.data.connectedContact[3]+'</p></li><li class="menu-5"><span></span><p>有效沟通量</p><p class="white">'+e.data.validedContact[3]+"</p></li>",$(".menu-box ul").html(t.mhtml),initBox1Datas(e.data)}}else console.log(e.code)},error:function(e){console.log(e)}})}function initBox1Datas(e){var t={};t.b111="";for(var a=e.totalContact[0].toString().split(""),n=0;n<a.length;n++)t.b111+="<span>"+a[n]+"</span>";t.b112="";for(var a=e.totalContact[1].toString().split(""),n=0;n<a.length;n++)t.b112+="<span>"+a[n]+"</span>";t.b113="";for(var a=e.totalContact[2].toString().split(""),n=0;n<a.length;n++)t.b113+="<span>"+a[n]+"</span>";$("#box-1 .h-datas li:eq(0) div").html(t.b111),$("#box-1 .h-datas li:eq(1) div").html(t.b112),$("#box-1 .h-datas li:eq(2) div").html(t.b113),t.b12=[{value:0,name:"市场"},{value:0,name:"技术"},{value:0,name:"其他"}],t.b12[0].value=Math.floor(1e4*e.totalContactPercent[2])/100,t.b12[1].value=Math.floor(1e4*e.totalContactPercent[0])/100,t.b12[2].value=Math.floor(1e4*e.totalContactPercent[1])/100,chart_1.setOption({series:[{data:t.b12}]});for(var o=Math.ceil(16*e.addedContactPercent[0]),l=Math.ceil(16*e.addedContactPercent[1]),c=Math.ceil(16*e.addedContactPercent[2]),i="",r="",s="",d=0;d<o;d++)i+="<span class='p1'></span>";for(var h=o;h<=16;h++)i+="<span></span>";for(var p=0;p<l;p++)r+="<span class='p2'></span>";for(var m=l;m<=16;m++)r+="<span></span>";for(var b=0;b<c;b++)s+="<span class='p3'></span>";for(var u=c;u<=16;u++)s+="<span></span>";$("#box-1 .h-bars-1 li:eq(0) div").html(i),$("#box-1 .h-bars-1 li:eq(1) div").html(r),$("#box-1 .h-bars-1 li:eq(2) div").html(s),$("#box-1 .h-bars-1 li:eq(0) h5").html(e.addedContact[0]),$("#box-1 .h-bars-1 li:eq(1) h5").html(e.addedContact[1]),$("#box-1 .h-bars-1 li:eq(2) h5").html(e.addedContact[2]),chart_2.setOption({color:["#6deae6","#ffb478","#82f875"],legend:{show:!1,data:[Math.floor(1e4*e.addedContactPercent[0])/100+"% 技术占比",Math.floor(1e4*e.addedContactPercent[1])/100+"% 其他占比",Math.floor(1e4*e.addedContactPercent[2])/100+"% 市场占比"]},series:[{type:"pie",clockWise:!1,radius:[41,46],label:{normal:{show:!1}},labelLine:{normal:{show:!1}},data:[{value:Math.floor(1e4*e.addedContactPercent[0])/100},{value:100-Math.floor(1e4*e.addedContactPercent[0])/100,itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[31,36],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:Math.floor(1e4*e.addedContactPercent[1])/100},{value:100-Math.floor(1e4*e.addedContactPercent[1])/100,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[21,26],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:Math.floor(1e4*e.addedContactPercent[2])/100},{value:100-Math.floor(1e4*e.addedContactPercent[2])/100,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]}]}),$("#box-1 .c-pie2 .e-titles .e-title:eq(0)").html(Math.floor(1e4*e.addedContactPercent[0])/100+"% 技术占比"),$("#box-1 .c-pie2 .e-titles .e-title:eq(1)").html(Math.floor(1e4*e.addedContactPercent[1])/100+"% 其他占比"),$("#box-1 .c-pie2 .e-titles .e-title:eq(2)").html(Math.floor(1e4*e.addedContactPercent[2])/100+"% 市场占比")}function initBox2Datas(e){e.icp=[],e.intentedContact[0]+e.intentedContact[1]+e.intentedContact[2]>0?(e.icp.push(e.intentedContact[0]/(e.intentedContact[0]+e.intentedContact[1]+e.intentedContact[2])),e.icp.push(e.intentedContact[1]/(e.intentedContact[0]+e.intentedContact[1]+e.intentedContact[2])),e.icp.push(e.intentedContact[2]/(e.intentedContact[0]+e.intentedContact[1]+e.intentedContact[2]))):(e.icp.push(0),e.icp.push(0),e.icp.push(0));for(var t=Math.ceil(25*e.icp[0]),a=Math.ceil(25*e.icp[1]),n=Math.ceil(25*e.icp[2]),o="",l="",c="",i=0;i<t;i++)o+="<span class='p1'></span>";for(var r=t;r<=25;r++)o+="<span></span>";for(var s=0;s<a;s++)l+="<span class='p2'></span>";for(var d=a;d<=25;d++)l+="<span></span>";for(var h=0;h<n;h++)c+="<span class='p3'></span>";for(var p=n;p<=25;p++)c+="<span></span>";$("#box-2 .h-bars li:eq(0) div").html(o),$("#box-2 .h-bars li:eq(1) div").html(l),$("#box-2 .h-bars li:eq(2) div").html(c),$("#box-2 .h-bars li:eq(0) p:eq(1)").html(e.intentedContact[0]),$("#box-2 .h-bars li:eq(1) p:eq(1)").html(e.intentedContact[1]),$("#box-2 .h-bars li:eq(2) p:eq(1)").html(e.intentedContact[2]),chart_dial_1.setOption({series:[{itemStyle:{normal:{color:"#2cdbd6"}},data:[{value:Math.floor(1e4*e.intentedContactPercent[0])/100,name:""}]}]}),chart_dial_2.setOption({series:[{itemStyle:{normal:{color:"#4aed3c"}},data:[{value:Math.floor(1e4*e.intentedContactPercent[1])/100,name:""}]}]}),chart_dial_3.setOption({series:[{itemStyle:{normal:{color:"#ff923a"}},data:[{value:Math.floor(1e4*e.intentedContactPercent[2])/100,name:""}]}]})}function initBox4Datas(e){e.ccp=[],e.connectedContact[0]+e.connectedContact[1]+e.connectedContact[2]>0?(e.ccp.push(e.connectedContact[0]/(e.connectedContact[0]+e.connectedContact[1]+e.connectedContact[2])),e.ccp.push(e.connectedContact[1]/(e.connectedContact[0]+e.connectedContact[1]+e.connectedContact[2])),e.ccp.push(e.connectedContact[2]/(e.connectedContact[0]+e.connectedContact[1]+e.connectedContact[2]))):(e.ccp.push(0),e.ccp.push(0),e.ccp.push(0));var t=Math.ceil(25*e.ccp[0]),a=Math.ceil(25*e.ccp[1]),n=Math.ceil(25*e.ccp[2]);console.log(t);for(var o="",l="",c="",i=0;i<t;i++)o+="<span class='p1'></span>";for(var r=t;r<=25;r++)o+="<span></span>";for(var s=0;s<a;s++)l+="<span class='p2'></span>";for(var d=a;d<=25;d++)l+="<span></span>";for(var h=0;h<n;h++)c+="<span class='p3'></span>";for(var p=n;p<=25;p++)c+="<span></span>";$("#box-4 .h-bars li:eq(0) div").html(o),$("#box-4 .h-bars li:eq(1) div").html(l),$("#box-4 .h-bars li:eq(2) div").html(c),$("#box-4 .h-bars li:eq(0) p:eq(1)").html(e.connectedContact[0]),$("#box-4 .h-bars li:eq(1) p:eq(1)").html(e.connectedContact[1]),$("#box-4 .h-bars li:eq(2) p:eq(1)").html(e.connectedContact[2]),chart_dial_4.setOption({series:[{itemStyle:{normal:{color:"#2cdbd6"}},data:[{value:Math.floor(1e4*e.connectedContactPercent[0])/100,name:""}]}]}),chart_dial_5.setOption({series:[{itemStyle:{normal:{color:"#4aed3c"}},data:[{value:Math.floor(1e4*e.connectedContactPercent[1])/100,name:""}]}]}),chart_dial_6.setOption({series:[{itemStyle:{normal:{color:"#ff923a"}},data:[{value:Math.floor(1e4*e.connectedContactPercent[2])/100,name:""}]}]})}var datas={},option_1={color:["#ffb478","#6deae6","#82f875"],series:[{type:"pie",radius:[25,35],center:["50%","45%"],roseType:"area",label:{normal:{show:!0,formatter:"{b} :{c}%",textStyle:{color:"#fff",fontSize:10}}},labelLine:{normal:{show:!0,length:1,length2:1,lineStyle:{color:"rgba(147,149,152,.3)"}}},data:[{value:0,name:"市场"},{value:0,name:"技术"},{value:0,name:"其他"}]}]},chart_1=new echarts.init(document.getElementById("echart-1"));chart_1.setOption(option_1);var option_2={color:["#6deae6","#ffb478","#82f875"],legend:{show:!1,data:["50% 技术占比","50% 其他占比","50% 市场占比"]},series:[{type:"pie",clockWise:!1,radius:[41,46],label:{normal:{show:!1}},labelLine:{normal:{show:!1}},data:[{value:50},{value:50,itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[31,36],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:50},{value:50,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[21,26],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:50},{value:50,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]}]},chart_2=new echarts.init(document.getElementById("echart-2"));chart_2.setOption(option_2);var option_small={series:[{type:"gauge",radius:"88%",startAngle:200,endAngle:-20,min:0,max:4,splitNumber:8,axisLine:{lineStyle:{color:[[1,"#fff"]],opacity:0}},splitLine:{length:10,lineStyle:{width:1,color:"#178cbb"}},axisTick:{length:7,lineStyle:{color:"#178cbb"}},axisLabel:{distance:2,textStyle:{color:"#ffffff",fontSize:"10"},formatter:function(e){switch(e+""){case"0":return"0";case"1":return"1";case"2":return"2";case"3":return"3";case"4":return"4"}}},pointer:{show:!0,length:"70%",width:4},itemStyle:{normal:{color:"#2cdbd6",fontSize:2}},detail:{offsetCenter:[0,"60%"],formatter:"{value}%",textStyle:{color:"#fff",fontSize:14}},data:[{value:0}]}]},chart_dial_1=new echarts.init(document.getElementById("echart-dial-1"));chart_dial_1.setOption(option_small);var chart_dial_2=new echarts.init(document.getElementById("echart-dial-2"));chart_dial_2.setOption(option_small);var chart_dial_3=new echarts.init(document.getElementById("echart-dial-3"));chart_dial_3.setOption(option_small);var option={series:[{type:"gauge",radius:"88%",startAngle:200,endAngle:-20,min:0,max:100,splitNumber:8,axisLine:{lineStyle:{color:[[1,"#fff"]],opacity:0}},splitLine:{length:10,lineStyle:{width:1,color:"#178cbb"}},axisTick:{length:7,lineStyle:{color:"#178cbb"}},axisLabel:{distance:2,textStyle:{color:"#ffffff",fontSize:"10"},formatter:function(e){switch(e+""){case"0":return"0";case"25":return"25";case"50":return"50";case"75":return"75";case"100":return"100"}}},pointer:{show:!0,length:"70%",width:4},itemStyle:{normal:{color:"#2cdbd6",fontSize:2}},detail:{offsetCenter:[0,"60%"],formatter:"{value}%",textStyle:{color:"#fff",fontSize:14}},data:[{value:0}]}]},chart_dial_4=new echarts.init(document.getElementById("echart-dial-4"));chart_dial_4.setOption(option);var chart_dial_5=new echarts.init(document.getElementById("echart-dial-5"));chart_dial_5.setOption(option);var chart_dial_6=new echarts.init(document.getElementById("echart-dial-6"));chart_dial_6.setOption(option),$(function(){function e(e){e.preventDefault()}var t=new Pdata,a=t.url(),n=t.token();null==n?window.location.href="index.html":getTableDatas(a,n,"2017-12"),$(".search-box .search-year").click(function(){event.stopPropagation(),$(this).find("ul").show()}),$(".search-box .search-year ul").click(function(){event.stopPropagation(),$(this).hide()}),$("body").click(function(){$(".search-box .search-year ul").hide()}),$(".search-box .search-month ul li").click(function(){$(".search-box .search-month ul li").removeClass("on"),$(this).addClass("on");var e=$(".search-box .search-year .tyear").attr("data-v")+"-"+$(".search-box .search-month ul li.on").attr("data-v");$(".content-box").hide(),$("#box-1").show(),getTableDatas(a,n,e)}),$(".menu-box ul").delegate("li","click",function(){var e=$(this).attr("data-box");if(void 0!=e&&"undefined"!=e&&null!=e&&""!=e){$(".content-box").hide(),$("#"+e).show();var t=$(this).index();if(t>2)for(a=0;a<t-2;a++){n=$(".menu-box ul li").eq(a);$(".menu-box ul li").eq(a).remove(),$(".menu-box ul").append(n)}else if(t<2)for(var a=4;a>t+2;a--){var n=$(".menu-box ul li").eq(a);$(".menu-box ul li").eq(a).remove(),$(".menu-box ul").prepend(n)}"box-1"==e&&initBox1Datas(datas),"box-2"==e&&initBox2Datas(datas),"box-4"==e&&initBox4Datas(datas)}else alert("功能扩展中")});var o,l,c=document.getElementById("change_box");c.addEventListener("touchstart",function(t){console.log(t);var a=t.touches[0];o=a.clientX-c.offsetLeft,l=a.clientY-c.offsetTop,document.addEventListener("touchmove",e,!1)},!1),c.addEventListener("touchmove",function(e){var t=e.touches[0],a=t.clientX-o,n=t.clientY-l;a<0?a=0:a>document.documentElement.clientWidth-c.offsetWidth&&(a=document.documentElement.clientWidth-c.offsetWidth),n<128&&(n=128),c.style.left=a+"px",c.style.top=n+"px"},!1),c.addEventListener("touchend",function(){document.removeEventListener("touchmove",e,!1)},!1)});