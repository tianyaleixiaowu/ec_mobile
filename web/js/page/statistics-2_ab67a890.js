function getTableDatas(t,e,a,n){var o=a+"-1",l=a+"-31";"2017-9"==a||"2017-11"==a?l=a+"-30":"2017-12"==a&&(l=a+"-"+(new Date).getDate()),$.ajax({type:"GET",async:!1,url:t+"/customer/saleState",headers:{token:e},data:{begin:o,end:l},dataType:"json",success:function(t){if("200"==t.code){if(null!=t.data){datas=t.data;var e={};e.mhtml='<li class="menu-3"><span></span><p>成单量</p><p class="white">'+t.data.saledContact[3]+'</p></li><li class="menu-2" data-box="box-2"><span></span><p>意向量</p><p class="white">'+t.data.intentedContact[3]+'</p></li><li class="menu-1" data-box="box-1"><span></span><p>动态线索</p><p class="white">'+t.data.totalContact[3]+'</p></li><li class="menu-4" data-box="box-4"><span></span><p>接通量</p><p class="white">'+t.data.connectedContact[3]+'</p></li><li class="menu-5"><span></span><p>有效沟通</p><p class="white">'+t.data.validedContact[3]+"</p></li>",$(".menu-box ul").html(e.mhtml),"box-1"==n&&initBox1Datas(datas),"box-2"==n&&initBox2Datas(datas),"box-4"==n&&initBox4Datas(datas),$(".menu-box ul li[data-box="+n+"]").addClass("currents")}}else console.log(t.code)},error:function(t){console.log(t)}})}function initBox1Datas(t){var e={};e.b111="";for(var a=t.totalContact[0].toString().split(""),n=0;n<a.length;n++)e.b111+="<span>"+a[n]+"</span>";e.b112="";for(var a=t.totalContact[1].toString().split(""),n=0;n<a.length;n++)e.b112+="<span>"+a[n]+"</span>";e.b113="";for(var a=t.totalContact[2].toString().split(""),n=0;n<a.length;n++)e.b113+="<span>"+a[n]+"</span>";$("#box-1 .h-datas li:eq(0) div").html(e.b111),$("#box-1 .h-datas li:eq(1) div").html(e.b112),$("#box-1 .h-datas li:eq(2) div").html(e.b113),e.b12=[{value:0,name:"市场"},{value:0,name:"技术"},{value:0,name:"其他"}],e.b12[0].value=Math.floor(1e4*t.totalContactPercent[2])/100,e.b12[1].value=Math.floor(1e4*t.totalContactPercent[0])/100,e.b12[2].value=Math.floor(1e4*t.totalContactPercent[1])/100,chart_1.setOption({series:[{data:e.b12}]});for(var o=Math.ceil(16*t.addedContactPercent[0]),l=Math.ceil(16*t.addedContactPercent[1]),c=Math.ceil(16*t.addedContactPercent[2]),i="",s="",r="",d=0;d<o;d++)i+="<span class='p1'></span>";for(var h=o;h<=16;h++)i+="<span></span>";for(var p=0;p<l;p++)s+="<span class='p2'></span>";for(var m=l;m<=16;m++)s+="<span></span>";for(var b=0;b<c;b++)r+="<span class='p3'></span>";for(var u=c;u<=16;u++)r+="<span></span>";$("#box-1 .h-bars-1 li:eq(0) div").html(i),$("#box-1 .h-bars-1 li:eq(1) div").html(s),$("#box-1 .h-bars-1 li:eq(2) div").html(r),$("#box-1 .h-bars-1 li:eq(0) h5").html(t.addedContact[0]),$("#box-1 .h-bars-1 li:eq(1) h5").html(t.addedContact[1]),$("#box-1 .h-bars-1 li:eq(2) h5").html(t.addedContact[2]),chart_2.setOption({color:["#6deae6","#82f875","#ffb478"],legend:{show:!1,data:[Math.floor(1e4*t.addedContactPercent[0])/100+"% 技术占比",Math.floor(1e4*t.addedContactPercent[1])/100+"% 其他占比",Math.floor(1e4*t.addedContactPercent[2])/100+"% 市场占比"]},series:[{type:"pie",clockWise:!1,radius:[41,46],label:{normal:{show:!1}},labelLine:{normal:{show:!1}},data:[{value:Math.floor(1e4*t.addedContactPercent[0])/100},{value:100-Math.floor(1e4*t.addedContactPercent[0])/100,itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[31,36],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:Math.floor(1e4*t.addedContactPercent[1])/100},{value:100-Math.floor(1e4*t.addedContactPercent[1])/100,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[21,26],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:Math.floor(1e4*t.addedContactPercent[2])/100},{value:100-Math.floor(1e4*t.addedContactPercent[2])/100,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]}]}),$("#box-1 .c-pie2 .e-titles .e-title:eq(0)").html(Math.floor(1e4*t.addedContactPercent[0])/100+"% 技术占比"),$("#box-1 .c-pie2 .e-titles .e-title:eq(1)").html(Math.floor(1e4*t.addedContactPercent[1])/100+"% 其他占比"),$("#box-1 .c-pie2 .e-titles .e-title:eq(2)").html(Math.floor(1e4*t.addedContactPercent[2])/100+"% 市场占比")}function initBox2Datas(t){t.icp=[],t.intentedContact[0]+t.intentedContact[1]+t.intentedContact[2]>0?(t.icp.push(t.intentedContact[0]/(t.intentedContact[0]+t.intentedContact[1]+t.intentedContact[2])),t.icp.push(t.intentedContact[1]/(t.intentedContact[0]+t.intentedContact[1]+t.intentedContact[2])),t.icp.push(t.intentedContact[2]/(t.intentedContact[0]+t.intentedContact[1]+t.intentedContact[2]))):(t.icp.push(0),t.icp.push(0),t.icp.push(0));for(var e=Math.ceil(25*t.icp[0]),a=Math.ceil(25*t.icp[1]),n=Math.ceil(25*t.icp[2]),o="",l="",c="",i=0;i<e;i++)o+="<span class='p1'></span>";for(var s=e;s<=25;s++)o+="<span></span>";for(var r=0;r<a;r++)l+="<span class='p2'></span>";for(var d=a;d<=25;d++)l+="<span></span>";for(var h=0;h<n;h++)c+="<span class='p3'></span>";for(var p=n;p<=25;p++)c+="<span></span>";$("#box-2 .h-bars li:eq(0) div").html(o),$("#box-2 .h-bars li:eq(1) div").html(l),$("#box-2 .h-bars li:eq(2) div").html(c),$("#box-2 .h-bars li:eq(0) p:eq(1)").html(t.intentedContact[0]),$("#box-2 .h-bars li:eq(1) p:eq(1)").html(t.intentedContact[1]),$("#box-2 .h-bars li:eq(2) p:eq(1)").html(t.intentedContact[2]),chart_dial_1.setOption({series:[{itemStyle:{normal:{color:"#2cdbd6"}},data:[{value:Math.floor(1e4*t.intentedContactPercent[0])/100,name:""}]}]}),chart_dial_2.setOption({series:[{itemStyle:{normal:{color:"#4aed3c"}},data:[{value:Math.floor(1e4*t.intentedContactPercent[1])/100,name:""}]}]}),chart_dial_3.setOption({series:[{itemStyle:{normal:{color:"#ff923a"}},data:[{value:Math.floor(1e4*t.intentedContactPercent[2])/100,name:""}]}]})}function initBox4Datas(t){t.ccp=[],t.connectedContact[0]+t.connectedContact[1]+t.connectedContact[2]>0?(t.ccp.push(t.connectedContact[0]/(t.connectedContact[0]+t.connectedContact[1]+t.connectedContact[2])),t.ccp.push(t.connectedContact[1]/(t.connectedContact[0]+t.connectedContact[1]+t.connectedContact[2])),t.ccp.push(t.connectedContact[2]/(t.connectedContact[0]+t.connectedContact[1]+t.connectedContact[2]))):(t.ccp.push(0),t.ccp.push(0),t.ccp.push(0));var e=Math.ceil(25*t.ccp[0]),a=Math.ceil(25*t.ccp[1]),n=Math.ceil(25*t.ccp[2]);console.log(e);for(var o="",l="",c="",i=0;i<e;i++)o+="<span class='p1'></span>";for(var s=e;s<=25;s++)o+="<span></span>";for(var r=0;r<a;r++)l+="<span class='p2'></span>";for(var d=a;d<=25;d++)l+="<span></span>";for(var h=0;h<n;h++)c+="<span class='p3'></span>";for(var p=n;p<=25;p++)c+="<span></span>";$("#box-4 .h-bars li:eq(0) div").html(o),$("#box-4 .h-bars li:eq(1) div").html(l),$("#box-4 .h-bars li:eq(2) div").html(c),$("#box-4 .h-bars li:eq(0) p:eq(1)").html(t.connectedContact[0]),$("#box-4 .h-bars li:eq(1) p:eq(1)").html(t.connectedContact[1]),$("#box-4 .h-bars li:eq(2) p:eq(1)").html(t.connectedContact[2]),chart_dial_4.setOption({series:[{itemStyle:{normal:{color:"#2cdbd6"}},data:[{value:Math.floor(1e4*t.connectedContactPercent[0])/100,name:""}]}]}),chart_dial_5.setOption({series:[{itemStyle:{normal:{color:"#4aed3c"}},data:[{value:Math.floor(1e4*t.connectedContactPercent[1])/100,name:""}]}]}),chart_dial_6.setOption({series:[{itemStyle:{normal:{color:"#ff923a"}},data:[{value:Math.floor(1e4*t.connectedContactPercent[2])/100,name:""}]}]})}var datas={},option_1={color:["#ffb478","#6deae6","#82f875"],series:[{type:"pie",radius:[25,35],center:["50%","45%"],roseType:"area",label:{normal:{show:!0,formatter:"{b} :{c}%",textStyle:{color:"#fff",fontSize:10}}},labelLine:{normal:{show:!0,length:1,length2:1,lineStyle:{color:"rgba(147,149,152,.3)"}}},data:[{value:0,name:"市场"},{value:0,name:"技术"},{value:0,name:"其他"}]}]},chart_1=new echarts.init(document.getElementById("echart-1"));chart_1.setOption(option_1);var option_2={color:["#6deae6","#82f875","#ffb478"],legend:{show:!1,data:["50% 技术占比","50% 其他占比","50% 市场占比"]},series:[{type:"pie",clockWise:!1,radius:[41,46],label:{normal:{show:!1}},labelLine:{normal:{show:!1}},data:[{value:50},{value:50,itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[31,36],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:50},{value:50,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]},{type:"pie",clockWise:!1,radius:[21,26],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:[{value:50},{value:50,name:"invisible",itemStyle:{normal:{color:"rgba(0,0,0,0)",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}}}]}]},chart_2=new echarts.init(document.getElementById("echart-2"));chart_2.setOption(option_2);var option_small={series:[{type:"gauge",radius:"88%",startAngle:200,endAngle:-20,min:0,max:40,splitNumber:8,axisLine:{lineStyle:{color:[[1,"#fff"]],opacity:0}},splitLine:{length:10,lineStyle:{width:1,color:"#178cbb"}},axisTick:{length:7,lineStyle:{color:"#178cbb"}},axisLabel:{distance:2,textStyle:{color:"#ffffff",fontSize:"10"},formatter:function(t){switch(t+""){case"0":return"0";case"10":return"10";case"20":return"20";case"30":return"30";case"40":return"40"}}},pointer:{show:!0,length:"70%",width:4},itemStyle:{normal:{color:"#2cdbd6",fontSize:2}},detail:{offsetCenter:[0,"60%"],formatter:"{value}%",textStyle:{color:"#fff",fontSize:14}},data:[{value:0}]}]},chart_dial_1=new echarts.init(document.getElementById("echart-dial-1"));chart_dial_1.setOption(option_small);var chart_dial_2=new echarts.init(document.getElementById("echart-dial-2"));chart_dial_2.setOption(option_small);var chart_dial_3=new echarts.init(document.getElementById("echart-dial-3"));chart_dial_3.setOption(option_small);var option={series:[{type:"gauge",radius:"88%",startAngle:200,endAngle:-20,min:0,max:100,splitNumber:8,axisLine:{lineStyle:{color:[[1,"#fff"]],opacity:0}},splitLine:{length:10,lineStyle:{width:1,color:"#178cbb"}},axisTick:{length:7,lineStyle:{color:"#178cbb"}},axisLabel:{distance:2,textStyle:{color:"#ffffff",fontSize:"10"},formatter:function(t){switch(t+""){case"0":return"0";case"25":return"25";case"50":return"50";case"75":return"75";case"100":return"100"}}},pointer:{show:!0,length:"70%",width:4},itemStyle:{normal:{color:"#2cdbd6",fontSize:2}},detail:{offsetCenter:[0,"60%"],formatter:"{value}%",textStyle:{color:"#fff",fontSize:14}},data:[{value:0}]}]},chart_dial_4=new echarts.init(document.getElementById("echart-dial-4"));chart_dial_4.setOption(option);var chart_dial_5=new echarts.init(document.getElementById("echart-dial-5"));chart_dial_5.setOption(option);var chart_dial_6=new echarts.init(document.getElementById("echart-dial-6"));chart_dial_6.setOption(option),$(function(){function t(t){t.preventDefault()}var e=new Pdata,a=e.url(),n=e.token();null==n?window.location.href="index.html":getTableDatas(a,n,"2017-12","box-1"),$(".search-box .search-year").click(function(){event.stopPropagation(),$(this).find("ul").show()}),$(".search-box .search-year ul").click(function(){event.stopPropagation(),$(this).hide()}),$("body").click(function(){$(".search-box .search-year ul").hide()}),$(".search-box .search-month ul li").click(function(){$(".search-box .search-month ul li").removeClass("on"),$(this).addClass("on");var t=$(".search-box .search-year .tyear").attr("data-v")+"-"+$(".search-box .search-month ul li.on").attr("data-v");$(".content-box").hide();var e=$(".menu-box ul li.currents").attr("data-box");$("#"+e).show(),getTableDatas(a,n,t,e)}),$(".menu-box ul").delegate("li","click",function(){var t=$(this).attr("data-box");void 0!=t&&"undefined"!=t&&null!=t&&""!=t?($(".content-box").hide(),$("#"+t).show(),$(".menu-box ul li").removeClass("currents"),$(this).addClass("currents"),"box-1"==t&&initBox1Datas(datas),"box-2"==t&&initBox2Datas(datas),"box-4"==t&&initBox4Datas(datas)):console.log("功能扩展中")});var o,l,c=document.getElementById("change_box");c.addEventListener("touchstart",function(e){console.log(e);var a=e.touches[0];o=a.clientX-c.offsetLeft,l=a.clientY-c.offsetTop,document.addEventListener("touchmove",t,!1)},!1),c.addEventListener("touchmove",function(t){var e=t.touches[0],a=e.clientX-o,n=e.clientY-l;a<0?a=0:a>document.documentElement.clientWidth-c.offsetWidth&&(a=document.documentElement.clientWidth-c.offsetWidth),n<128&&(n=128),c.style.left=a+"px",c.style.top=n+"px"},!1),c.addEventListener("touchend",function(){document.removeEventListener("touchmove",t,!1)},!1);var i=$(".container .menu-box").offset().top;$(".container .nav-list").offset().top-i<=$(".container .menu-box").height()&&$(".container .menu-box").css("margin-top","0")});