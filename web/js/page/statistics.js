function initCharts1Datas(e){var t={110000:"北京市",120000:"天津市",130000:"河北省",140000:"山西省",150000:"内蒙古自治区",210000:"辽宁省",220000:"吉林省",230000:"黑龙江省",310000:"上海市",320000:"江苏省",330000:"浙江省",340000:"安徽省",350000:"福建省",360000:"江西省",370000:"山东省",410000:"河南省",420000:"湖北省",430000:"湖南省",440000:"广东省",450000:"广西壮族自治区",460000:"海南省",500000:"重庆市",510000:"四川省",520000:"贵州省",530000:"云南省",540000:"西藏自治区",610000:"陕西省",620000:"甘肃省",630000:"青海省",640000:"宁夏回族自治区",650000:"新疆维吾尔自治区"},o={110000:[116.46,39.92],120000:[117.2,39.13],130000:[114.48,38.03],140000:[112.53,37.87],150000:[111.65,40.82],210000:[123.38,41.8],220000:[125.35,43.88],230000:[126.63,45.75],310000:[121.48,31.22],320000:[118.78,32.04],330000:[120.19,30.26],340000:[117.27,31.86],350000:[119.3,26.08],360000:[115.89,28.68],370000:[117,36.65],410000:[113.65,34.76],420000:[114.31,30.52],430000:[113,28.21],440000:[113.23,23.16],450000:[108.33,22.84],460000:[110.35,20.02],500000:[106.54,29.59],510000:[104.06,30.67],520000:[106.71,26.57],530000:[102.73,25.04],540000:[91.11,29.97],610000:[108.95,34.27],620000:[103.73,36.03],630000:[101.74,36.56],640000:[106.27,38.47],650000:[87.68,43.77]},f={backgroundColor:"#2f84ff",title:{text:"爬取线索热点分布",textStyle:{color:"#ffffff"},x:"center"},tooltip:{trigger:"item",formatter:function(e){return e.name+" : "+e.value[2]}},visualMap:{min:0,max:200,inRange:{color:["#50a3ba","#eac736","#d94e5d"]},show:!1},geo:{map:"china",label:{emphasis:{show:!1}},itemStyle:{normal:{areaColor:"transparent",borderColor:"#ffffff"},emphasis:{areaColor:"transparent"}}},series:[{name:"分布情况",type:"scatter",coordinateSystem:"geo",data:function(e){for(var f=[],a=0;a<e.length;a++){var n=o[e[a].province];n&&f.push({name:t[e[a].province],value:n.concat(e[a].count)})}return f}(e),symbolSize:12,label:{normal:{show:!1},emphasis:{show:!1}},itemStyle:{emphasis:{borderColor:"#fff",borderWidth:2}}}]};new echarts.init(document.getElementById("charts-1")).setOption(f)}function initCharts2Datas(e,t){var o={color:["#ffffff"],backgroundColor:"#2f84ff",title:{text:"爬取线索日增量",textStyle:{color:"#ffffff"},x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"20%",left:"2%",right:"2%",bottom:"20%",containLabel:!0},xAxis:[{type:"category",data:e,axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff",interval:0,rotate:40}}],yAxis:[{min:0,axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff",formatter:"{value}"},data:{textStyle:{color:"#ffffff"}},type:"value"}],series:[{name:"新增量",type:"bar",barWidth:"30%",data:t}]};echarts.init(document.getElementById("charts-2")).setOption(o)}function initCharts3Datas(e,t,o){var f={backgroundColor:"#2f84ff",title:{text:"平台数据使用情况",textStyle:{color:"#ffffff"},x:"center"},legend:{show:!1},tooltip:{trigger:"axis",axisPointer:{animation:!1}},toolbox:{show:!1},axisPointer:{color:"#ffffff",link:{xAxisIndex:"all"}},dataZoom:[{show:!1,start:0,end:100,xAxisIndex:[0,1]}],grid:[{left:40,right:40,height:"33%"},{left:40,right:40,top:"55%",height:"33%"}],xAxis:[{type:"category",axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"},boundaryGap:!1,data:e},{gridIndex:1,color:"#ffffff",type:"category",axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"},boundaryGap:!1,data:e,position:"top"}],yAxis:[{name:"使用人数",type:"value",axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"}},{gridIndex:1,name:"推送线索量",type:"value",color:"#ffffff",inverse:!0,axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"}}],series:[{name:"使用人数",type:"line",color:"#ffffff",symbolSize:8,hoverAnimation:!1,data:t,textStyle:{color:"#ffffff"}},{name:"推送线索量",color:"#ffffff",type:"line",xAxisIndex:1,yAxisIndex:1,symbolSize:8,hoverAnimation:!1,data:o,textStyle:{color:"#ffffff"}}]};echarts.init(document.getElementById("charts-3")).setOption(f)}function getLocalDate(e){return getLocalTime(e.toString().substring(0,e.toString().length-3))}function getLocalTime(e){return new Date(1e3*parseInt(e)).toLocaleString().substr(0,10)}function getDate(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function getBeforeDate(e){var e=e,t=new Date,o=t.getFullYear(),f=t.getMonth()+1,a=t.getDate();return a<=e&&(f>1?f-=1:(o-=1,f=12)),t.setDate(t.getDate()-e),o=t.getFullYear(),f=t.getMonth()+1,a=t.getDate(),s=o+"-"+(f<10?"0"+f:f)+"-"+(a<10?"0"+a:a),s}function getToken(){var e=(new Cookies).getChild("md_user","token");if(null!=e&&""!=e)return e;window.location.href="index.html"}$(function(){url="http://47.92.107.76/server",token=getToken(),$.ajax({type:"GET",url:url+"/contact/province",headers:{token:token},dataType:"json",success:function(e){"200"==e.code?initCharts1Datas(e.data):console.log(e.code)},error:function(e){console.log(e)}});var e=getBeforeDate(4),t=getDate();$.ajax({type:"GET",url:url+"/contact/dayCount",headers:{token:token},data:{begin:e,end:t},dataType:"json",success:function(e){if("200"==e.code){for(var t=e.data,o=[],f=[],a=0;a<t.length;a++)o.push(getLocalDate(t[a].date)),f.push(t[a].count);initCharts2Datas(o,f)}else console.log(e.code)},error:function(e){console.log(e)}}),$.ajax({type:"GET",url:url+"/push/count",headers:{token:token},data:{begin:e,end:t},dataType:"json",success:function(e){if("200"==e.code){for(var t=e.data,o=[],f=[],a=[],n=0;n<t.length;n++)o.push(getLocalDate(t[n].pushDate)),f.push(t[n].user),a.push(t[n].total);initCharts3Datas(o,f,a)}else console.log(e.code)},error:function(e){console.log(e)}})});