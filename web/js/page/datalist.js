function getWebsiteList(e,t){var i=[];return $.ajax({type:"GET",async:!1,url:e+"/codeWeb",headers:{token:t},dataType:"json",success:function(e){"200"==e.code?i=e.data:console.log(e.code)},error:function(e){console.log(e)}}),i}function getSizeList(e,t){var i=[];return $.ajax({type:"GET",async:!1,url:e+"/codeSize",headers:{token:t},dataType:"json",success:function(e){"200"==e.code?i=e.data:console.log(e.code)},error:function(e){console.log(e)}}),i}function getDetails(e,t,i,a){var o={};return $.ajax({type:"GET",async:!1,url:e+"/contact/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded",token:t},dataType:"json",success:function(e){"200"==e.code?(null!=(o=e.data).phone&&""!=o.phone?o.phone=o.phone.substring(0,3)+"****"+o.phone.substring(o.phone.length-4,o.phone.length):null!=o.mobile&&""!=o.mobile&&(o.phone=o.mobile.substring(0,3)+"****"+o.mobile.substring(o.mobile.length-4,o.mobile.length)),o.jobName=o.jobName.length>48?o.jobName.substring(0,48)+"...":o.jobName,o.score=a):console.log(e.code)},error:function(e){console.log(e)}}),o}function getPushData(e,t){var i={pushedCount:"0",pushTotal:"0",percent:"0"};return $.ajax({type:"GET",async:!1,url:e+"/user/pushCount",headers:{token:t},dataType:"json",success:function(e){"200"==e.code?(i.pushedCount=e.data.pushedCount,i.pushTotal=e.data.threshold,i.percent=Math.round(100*i.pushedCount/i.pushTotal)+"%"):console.log(e.code)},error:function(e){console.log(e)}}),i}function getTableData(e,t,i){var a={totalPage:0,totalCount:0,list:null};return $.ajax({type:"POST",async:!1,url:e+"/contact",headers:{"Content-Type":"application/json",token:t},data:JSON.stringify(i),dataType:"json",success:function(e){if("200"==e.code)if(a.totalPage=e.data.totalPage,a.totalCount=e.data.totalCount,e.data.list.length>0){a.list=e.data.list;for(var t=0;t<a.list.length;t++)a.list[t].province=a.list[t].province.length>3?a.list[t].province.substring(0,3)+"..":a.list[t].province,a.list[t].mobile=a.list[t].mobile.substring(0,3)+"****"+a.list[t].mobile.substring(a.list[t].mobile.length-4,a.list[t].mobile.length),a.list[t].name=a.list[t].name.length>3?a.list[t].name.substring(0,3)+"..":a.list[t].name,a.list[t].companyScore=Math.round(100*a.list[t].companyScore)}else a.list=null;else console.log(e.code)},error:function(e){console.log(e)}}),a}function setSearchInfo(e){var t=e;t.page=0,t.extra=$.trim($("#txt-extra").val()),""==t.extra&&(t.extra=null),t.provinces=[];var i=$(".li-info .li-items #province-items li.current");i.length>0&&t.provinces.push(i.attr("data-id")),t.vocations=[];var a=$(".li-info .li-items #vocation-items li.current");a.length>0&&t.vocations.push(a.attr("data-id")),t.memberSizeTags=[];var o=$(".li-info .li-items #size-items li.current");o.length>0&&t.memberSizeTags.push(o.attr("data-id")),t.websiteIds=[];var n=$(".li-info .li-items #website-items li.current");return n.length>0&&t.websiteIds.push(n.attr("data-id")),t}function getToken(){var e=(new Cookies).getChild("md_user","token");if(null!=e&&""!=e)return e;window.location.href="index.html"}function getProvinceList(){return[{id:"110000",name:"北京市"},{id:"120000",name:"天津市"},{id:"130000",name:"河北省"},{id:"140000",name:"山西省"},{id:"150000",name:"内蒙古自治区"},{id:"210000",name:"辽宁省"},{id:"220000",name:"吉林省"},{id:"230000",name:"黑龙江省"},{id:"310000",name:"上海市"},{id:"320000",name:"江苏省"},{id:"330000",name:"浙江省"},{id:"340000",name:"安徽省"},{id:"350000",name:"福建省"},{id:"360000",name:"江西省"},{id:"370000",name:"山东省"},{id:"410000",name:"河南省"},{id:"420000",name:"湖北省"},{id:"430000",name:"湖南省"},{id:"440000",name:"广东省"},{id:"450000",name:"广西壮族自治区"},{id:"460000",name:"海南省"},{id:"500000",name:"重庆市"},{id:"510000",name:"四川省"},{id:"520000",name:"贵州省"},{id:"530000",name:"云南省"},{id:"540000",name:"西藏自治区"},{id:"610000",name:"陕西省"},{id:"620000",name:"甘肃省"},{id:"630000",name:"青海省"},{id:"640000",name:"宁夏回族自治区"},{id:"650000",name:"新疆维吾尔自治区"},{id:"710000",name:"台湾省"},{id:"810000",name:"香港特别行政区"},{id:"820000",name:"澳门特别行政区"}]}function getVocationList(){return[{vocationCode:"1",vocationName:"IT/通信/电子/互联网"},{vocationCode:"2",vocationName:"金融业"},{vocationCode:"3",vocationName:"房地产/建筑业"},{vocationCode:"4",vocationName:"法律"},{vocationCode:"5",vocationName:"商业服务"},{vocationCode:"6",vocationName:"医疗/健康"},{vocationCode:"7",vocationName:"贸易/批发/零售/租赁业"},{vocationCode:"8",vocationName:"生产/加工/制造"},{vocationCode:"9",vocationName:"交通/运输/物流/仓储"},{vocationCode:"10",vocationName:"服务业"},{vocationCode:"11",vocationName:"体育/休闲/旅游/娱乐"},{vocationCode:"12",vocationName:"能源/矿产/环保"},{vocationCode:"13",vocationName:"政府/非盈利机构"},{vocationCode:"14",vocationName:"媒体"},{vocationCode:"15",vocationName:"教育"},{vocationCode:"16",vocationName:"农/林/牧/渔"},{vocationCode:"17",vocationName:"跨领域经营"},{vocationCode:"18",vocationName:"其他"}]}$(function(){url="http://47.92.107.76/server",new Vue({el:"#datalist",data:{token:"",provinceMap:getProvinceList(),vocationMap:getVocationList(),sizeMap:[],websiteMap:[],pushData:{},tableData:{},searchInfo:{page:0,size:10},detailInfo:{}},methods:{select:function(e){$(".search-item .items li").removeClass("current"),$("#"+e).addClass("current"),$(".li-info .li-items ul").hide(),$(".li-info").show(),$("#"+e+"-items").show(),$(".list").hide()},search:function(){var e=this;e.token=getToken();var t=$(".li-info .li-items #province-items li.current");t.length>0?$(".search-item #province span:first-child").html(t.html()):$(".search-item #province span:first-child").html("区域");var i=$(".li-info .li-items #vocation-items li.current");i.length>0?$(".search-item #vocation span:first-child").html(i.html()):$(".search-item #vocation span:first-child").html("行业");var a=$(".li-info .li-items #size-items li.current");a.length>0?$(".search-item #size span:first-child").html(a.html()):$(".search-item #size span:first-child").html("规模");var o=$(".li-info .li-items #website-items li.current");o.length>0?$(".search-item #website span:first-child").html(o.html()):$(".search-item #website span:first-child").html("来源"),$(".search-item ul li").removeClass("current"),$(".li-info").hide(),$(".list").show();var n=setSearchInfo(e.searchInfo);e.tableData=getTableData(url,e.token,n)},next:function(){var e=this;e.token=getToken(),e.searchInfo.page++,e.searchInfo.page==e.tableData.totalPage-1&&(e.searchInfo.page=0),e.tableData=getTableData(url,e.token,e.searchInfo)},detail:function(e,t){var i=this;i.token=getToken(),i.detailInfo=getDetails(url,i.token,e,t),$("#li-detail").show()},push:function(e){event.stopPropagation();var t=this;t.token=getToken(),$.ajax({type:"POST",url:url+"/push",headers:{"Content-Type":"application/json",token:t.token},data:JSON.stringify({ids:[e]}),dataType:"json",success:function(e){"200"==e.code?(t.pushData=getPushData(url,t.token),t.tableData=getTableData(url,t.token,t.searchInfo),$("#li-detail").hide(),$(".shade-items .shade-msg").html("线索数据推送成功"),$(".shade-items").show()):(console.log(e.code),$("#li-detail").hide(),$(".shade-items .shade-msg").html("线索数据推送失败，请稍后重试"),$(".shade-items").show())},error:function(e){console.log(e)}})}},created:function(){var e=this;e.token=getToken(),e.sizeMap=getSizeList(url,e.token),e.websiteMap=getWebsiteList(url,e.token),e.pushData=getPushData(url,e.token),e.tableData=getTableData(url,e.token,e.searchInfo)}}),$(".li-info .li-items ul li").click(function(){$(this).parents("ul").find("li").removeClass("current"),$(this).addClass("current")}),$("#reset-search").click(function(){$(".li-info .li-items ul:visible").find("li").removeClass("current")}),$(".shade-items .shade-close").click(function(){$(".shade-items").hide()}),$(".shade-detail .shade-close-1").click(function(){$(".shade-detail").hide()})});